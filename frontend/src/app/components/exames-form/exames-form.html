<div class="card shadow-sm">
  <div class="card-header bg-primary text-white">
    <h5 class="mb-0"><i class="bi bi-file-medical-fill me-2"></i>Cadastrar Exame</h5>
  </div>
  <div class="card-body">
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Paciente *</label>
          <select 
            class="form-select" 
            formControlName="pacienteId"
            [class.is-invalid]="form.get('pacienteId')?.invalid && form.get('pacienteId')?.touched">
            <option value="">Selecione um paciente</option>
            <option *ngFor="let p of pacientes" [value]="p.id">{{ p.nome }} - {{ p.documento }}</option>
          </select>
          <div class="invalid-feedback">
            Selecione um paciente
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label class="form-label">Modalidade DICOM *</label>
          <select 
            class="form-select" 
            formControlName="modalidade"
            [class.is-invalid]="form.get('modalidade')?.invalid && form.get('modalidade')?.touched">
            <option value="">Selecione uma modalidade</option>
            <option *ngFor="let mod of modalidades" [value]="mod.value">
              {{ mod.value }} - {{ mod.label }}
            </option>
          </select>
          <div class="invalid-feedback">
            Selecione uma modalidade
          </div>
        </div>

        <div class="col-12 mb-3">
          <label class="form-label">Descrição</label>
          <textarea 
            class="form-control" 
            formControlName="descricao"
            rows="3"
            placeholder="Descrição opcional do exame"></textarea>
        </div>
      </div>

      <div class="alert alert-success" *ngIf="successMessage">
        <i class="bi bi-check-circle me-2"></i>{{ successMessage }}
      </div>

      <div class="alert alert-danger" *ngIf="errorMessage">
        <i class="bi bi-exclamation-triangle me-2"></i>{{ errorMessage }}
      </div>

      <div class="d-flex gap-2">
        <button type="submit" class="btn btn-primary" [disabled]="loading || form.invalid">
          <span *ngIf="loading" class="spinner-border spinner-border-sm me-2"></span>
          Salvar
        </button>
        <button type="button" class="btn btn-secondary" (click)="onCancel()" [disabled]="loading">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
